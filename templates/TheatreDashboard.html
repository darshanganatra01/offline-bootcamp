<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theatre Dashboard</title>
</head>
<body>
    <h2>Welcome, {{ current_theatre.theatre_name }}</h2>

    <!-- TODAY'S BOOKINGS -->
    {% if todays_bookings %}
    <form method="POST" action="{{ url_for('complete_booking') }}">
        {% for booking, email in todays_bookings %}
            <div style="margin-bottom:10px; border-bottom:1px solid #ccc; padding:5px;">
                <p>
                    ‚è∞ Time: {{ booking.booking_time.strftime('%H:%M') }}  
                    üë§ Booked by: {{ email }}
                </p>
                <label for="feedback_{{ booking.bid }}">Feedback:</label><br>
                <textarea name="feedback_{{ booking.bid }}" id="feedback_{{ booking.bid }}" rows="2" cols="40"
                          placeholder="Enter feedback for this booking..."></textarea><br>
                
                <!-- Button to complete booking -->
                <button type="submit" name="booking_id" value="{{ booking.bid }}"
                        onclick="return confirm('Mark this booking as completed?');">
                    ‚úÖ Complete Booking
                </button>
            </div>
        {% endfor %}
    </form>
{% else %}
    <p>No appointments today.</p>
{% endif %}

    <hr>

    <!-- UPCOMING BOOKINGS -->
    <h3>Upcoming Bookings (Next 7 Days)</h3>
    {% if upcoming_bookings %}
        {% for booking, email in upcoming_bookings %}
            <p>
                On: {{ booking.booking_date.strftime('%Y-%m-%d') }}
                at {{ booking.booking_time.strftime('%H:%M') }}
                - Booked by: {{ email }}
            </p>
        {% endfor %}
    {% else %}
        <p>You have no upcoming bookings in the next 7 days.</p>
    {% endif %}

    <hr>

    <!-- SLOT SETUP REMINDER -->
    <h3>Slot Setup Reminder</h3>
    {% if missing_dates %}
        <p>You have not created any slots for the following days (next 7 days):</p>
        <ul>
            {% for day in missing_dates %}
                <li>{{ day.strftime('%A, %Y-%m-%d') }}</li>
            {% endfor %}
        </ul>
        <a href="/manage-slots">Go to Manage Slots</a>
    {% else %}
        <p>‚úÖ Great job! You have created slots for all the next 7 days.</p>
    {% endif %}
</body>
</html>
